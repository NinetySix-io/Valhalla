syntax = "proto3";

package serv.orgs;

service OrgsService {
    rpc CreateOrg(CreateOrgRequest) returns (Organization) {}
    rpc GetOrg(GetOrgRequest) returns (Organization) {}
    rpc ArchiveOrg(ArchiveOrgRequest) returns (Organization) {}
    rpc RestoreOrg(RestoreOrgRequest) returns (Organization) {}
    rpc UpdateOrgPlan(UpdateOrgPlanRequest) returns(Organization) {}
    rpc UpdateOrgLogo(UpdateOrgLogoRequest) returns(Organization) {}

    rpc SetAccountActiveOrg(SetAccountActiveOrgRequest) returns(SetAccountActiveOrgResponse) {}
    rpc GetAccountActiveOrg(GetAccountActiveOrgRequest) returns (GetAccountActiveOrgResponse) {}

    // rpc InviteMember(InviteMemberRequest) returns (InviteMemberResponse) {}
    // rpc AcceptMemberInvitation(AcceptMemberInvitationRequest) returns (AcceptMemberInvitationResponse) {}
    rpc MarkDeleteMember(MarkDeleteMemberRequest) returns (MarkDeleteMemberResponse) {}
    rpc GetMember(GetMemberRequest) returns (Member) {}
    rpc GetUserMemberships(GetUserMembershipsRequest) returns (GetUserMembershipsResponse) {}
}

message AccountSettings {
    string activeOrganizationId = 1;
}

message GetAccountActiveOrgRequest {
    string accountId = 1;
}

message GetAccountActiveOrgResponse {
    optional Organization organization = 1;
}

message SetAccountActiveOrgRequest {
    string accountId = 1;
    string organizationId = 2;
}

message SetAccountActiveOrgResponse {
    bool success = 1;
}

message GetUserMembershipsRequest {
    string userId = 1;
}

message GetUserMembershipsResponse {
    repeated Organization organizations = 1;
}

message Organization {
    string id = 1;
    string slug = 2;
    string name = 3;
    string createdBy = 4;
    string createdAt = 5;
    string updateBy = 6;
    string updatedAt = 7;
    string logoUrl = 8;
    OrgStatus status = 9;
}

enum OrgPlan {
    FREE = 0;
}

enum OrgStatus {
    ACTIVE = 0;
    INACTIVE = 1;
    SUSPENDED = 2;
}

enum InvitationStatus {
    PENDING = 0;
    ACCEPTED = 1;
    REJECTED = 2;
}

enum OrgRole {
    OWNER = 0;
    ADMIN = 1;
    DEVELOPER = 2;
    MEMBER = 3;
    GUESS = 4;
}

message UpdateOrgLogoRequest {
    string imageUrl = 1;
    string orgId = 2;
    string requestedUserId = 3;
}

message UpdateOrgPlanRequest {
    OrgPlan plan = 1;
    string orgId = 2;
    string requestedUserId = 3;
}

message Member {
    string id = 1;
    string user = 2;
    string organization = 3;
    string invitedBy = 4;
    string status = 5;
    string role = 6;
    string createdAt = 7;
    string updatedAt = 8;
    string updatedBy = 9;
    string profileImageUrl = 10;
}

message CreateOrgRequest {
    string name = 1;
    string requestedUserId = 2;
    OrgPlan plan = 3;

}

message ArchiveOrgRequest {
    string orgId = 1;
    string requestedUserId = 2;
}

message RestoreOrgRequest {
    string orgId = 1;
    string requestedUserId = 2;
}

message GetOrgRequest {
    string orgId = 1;
}

message InviteMemberRequest {
    string email = 2;
    string userId = 3;
    string role = 6;
}

message InviteMemberResponse {
    Member member = 1;
}

message MarkDeleteMemberRequest {
    string orgId = 1;
    string memberId = 2;
    string requestedUserId = 3;
}

message MarkDeleteMemberResponse {
    Member member = 1;
}

message GetMemberRequest {
    string orgId = 1;
    string userId = 2;
}

message AcceptMemberInvitationRequest {
    string token = 1;
}

message AcceptMemberInvitationResponse {
    Member member = 1;
}
